## 1. 퀘스트 조회 관련 파일 추가 (작은 단위로 분리해서 구성함. 다른 화면들도 작게 분리해서 관리할 예정.)

### 요약

- 타입/공통 유틸
    - `src/types/quest.ts`
    - `src/utils/confirmAsync.ts`
- 퀘스트 화면 전용
    - `src/hooks/useQuestsScreen.ts`
    - `src/components/quests/QuestStatusChip.tsx`
    - `src/components/quests/QuestCard.tsx`
    - `src/components/quests/QuestDetailModal.tsx`
- 화면 엔트리
    - `app/quests/index.tsx`

### 파일별 설명

### 1. `src/types/quest.ts`

**역할: 도메인 타입 정의 모음**

- 퀘스트 화면에서 공통으로 사용하는 **도메인 타입**들을 모아둔 파일.
- 정의 내용:
    - `UserRole` : `'PARENT' | 'CHILD'`
    - `QuestStatus` : `'REGISTERED' | 'REQUESTED' | 'COMPLETED'`
    - `Profile` : 로그인한 유저의 id, role, nickname
    - `Quest` : 퀘스트 한 건에 대한 구조(제목, 내용, 보상, 상태 등)
- **언제 수정?**
    - DB 스키마가 바뀌거나(컬럼 추가/삭제), 퀘스트 관련 화면이 늘어나서 공통 타입이 필요할 때.

---

### 2. `src/utils/confirmAsync.ts`

**역할: “정말 할 거야?” 확인 팝업 유틸**

- 버튼 눌렀을 때 **한 번 더 확인하는 공통 로직**.
- React Native + 웹 동시 지원:
    - 웹: `window.confirm`
    - 앱: `Alert.alert`
- `confirmAsync(title, message)` → `Promise<boolean>` 반환.
    - `true`면 사용자 “확인”
    - `false`면 “취소”
- **언제 수정?**
    - 앱 전체에서 사용하는 confirm UI를 바꾸고 싶을 때(커스텀 모달로 교체 등).

---

### 3. `src/components/quests/QuestStatusChip.tsx`

**역할: 퀘스트 상태 뱃지**

- `REGISTERED / REQUESTED / COMPLETED` 상태에 따라
    - 라벨(텍스트)
    - 색상, 테두리, 배경
        
        를 예쁘게 보여주는 **뱃지 컴포넌트**.
        
- 어디서 쓰냐:
    - 퀘스트 카드 상단
    - 상세 모달 상단
- **언제 수정?**
    - 상태 표시 색감을 바꾸고 싶을 때
    - 새 상태가 추가될 때(예: `EXPIRED`) → 여기만 수정하면 전체에 반영됨.

---

### 4. `src/components/quests/QuestCard.tsx`

**역할: 리스트에서 보이는 “퀘스트 카드” UI**

- 퀘스트 리스트에서 한 줄 한 줄 보여주는 카드 컴포넌트.
- 보여주는 내용:
    - 제목
    - 보상 (COIN)
    - D-Day (`ddayLabel` props로 주입)
    - 상태 뱃지(`QuestStatusChip`)
    - 역할별 버튼
        - 부모: 삭제 / (REQUESTED일 때) 승인
        - 자녀: REGISTERED일 때 완료 요청
- 실제 동작(삭제/승인/요청)은 **부모 컴포넌트에서 함수로 넘겨줌** (`onDelete`, `onApprove`, `onRequest`).
- **언제 수정?**
    - 카드 레이아웃/디자인 바꾸고 싶을 때
    - 버튼 구성을 바꾸고 싶을 때(예: 아이콘 버튼, 비활성 조건 등).

---

### 5. `src/components/quests/QuestDetailModal.tsx`

**역할: 퀘스트 상세 보기 팝업**

- 퀘스트 카드 터치 시 열리는 **상세 모달 UI**.
- 보여주는 내용:
    - 제목
    - 상태 뱃지
    - 보상
    - D-Day
    - 본문 내용(content)
- 하단에도 역할별 버튼:
    - 부모: 삭제 / 승인
    - 자녀: 완료 요청
- 실제 로직은 여기서 안 하고, `onDelete`, `onApprove`, `onRequest` 콜백으로만 위임.
- **언제 수정?**
    - 상세 레이아웃, 글꼴, 여백 수정
    - 상세에서만 보이는 추가 정보(예: 생성일, 완료일)를 더 보여주고 싶을 때.

---

### 6. `src/hooks/useQuestsScreen.ts`

**역할: 퀘스트 화면의 데이터/상태 관리 로직**

- 이 훅이 **비즈니스 로직의 중심**.
- 하는 일:
    1. 로그인 유저 확인 (`supabase.auth.getUser`)
    2. `users`에서 내 프로필 조회 (id, role, nickname)
    3. `balances`에서 내 잔액 조회
    4. `quests`에서 RLS가 허용하는 퀘스트 목록 조회
    5. 퀘스트 선택/모달 열기/닫기 관리
    6. 상태 변경 로직
        - 삭제: `deleteQuest`
        - 자녀의 요청: `childRequestQuest` (REGISTERED → REQUESTED)
        - 부모의 승인: `parentApproveQuest` (REQUESTED → COMPLETED)
    7. D-Day 라벨 함수: `getDDayLabel`
- 반환값:
    - `profile, balance, quests, loading, mutating`
    - `selectedQuest, modalVisible`
    - 액션 함수들: `openQuest, closeQuest, deleteQuest, childRequestQuest, parentApproveQuest, getDDayLabel`
- **언제 수정?**
    - Supabase 쿼리 바꾸고 싶을 때
    - RLS 정책 변경에 따라 조회 조건이 바뀔 때
    - 퀘스트 상태 흐름(REGISTERED → REQUESTED → COMPLETED) 로직을 변경/추가할 때
    - 추후 보상 지급(밸런스/트랜잭션 업데이트)을 여기에 붙일 때.

---

### 7. `app/quests/index.tsx`

**역할: 실제 화면 엔트리(페이지) – “퀘스트 목록 화면”**

- 유저가 `/quests`에 들어왔을 때 처음 보는 **메인 화면**.
- 하는 일:
    - `useQuestsScreen()` 훅을 호출해서
        
        데이터 + 액션을 받아온 뒤
        
    - 그걸 가지고 화면을 **조합**만 함.
- 상단:
    - 내 재화 (COIN)
    - 부모일 경우: `퀘스트 등록` 버튼 → `/quests/new`로 이동
- 중앙:
    - “오늘의 퀘스트” 타이틀
    - 로딩/빈 상태/리스트 렌더링 분기
    - `QuestCard`를 리스트로 렌더링
- 하단(또는 오버레이):
    - `QuestDetailModal` (카드 터치 시 열림)
- **언제 수정?**
    - 전체 레이아웃 구조(상단/리스트/바닥 여백)를 변경할 때
    - 다른 탭, 필터(예: 상태별 필터)를 추가하고 싶을 때
    - `/quests` 화면의 전체 UX 흐름을 바꾸고 싶을 때.

---

### 한 줄 정리

- **타입**: `quest.ts`
- **공통 유틸**: `confirmAsync`
- **상태 UI**: `QuestStatusChip`
- **리스트 카드 UI**: `QuestCard`
- **상세 팝업 UI**: `QuestDetailModal`
- **비즈니스 로직/데이터**: `useQuestsScreen`
- **실제 페이지 조립**: `app/quests/index.tsx`

<br><br>

## 2.  퀘스트 등록 화면 추가(팝업)

### `QuestCreateModal.tsx` 새로 추가

역할: 제목/내용/재화 입력받는 “퀘스트 등록 팝업”

부모만 쓰고, 내용은 선택, 제목/재화는 필수