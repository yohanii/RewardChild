## 1. fix: 부모-자녀 연결 시, relation 조회하는데 RLS 정책에 막히는 문제 해결

해결

- 부모(`users.role='PARENT'`)만 `relations`에 새 행을 삽입할 수 있고,
- 부모와 자녀는 자신이 관련된 관계만 조회 가능.

```sql
-- 조회 코드
const { data: existing, error: relationErr } = await supabase
        .from('relations')
        .select('*')
        .eq('parent_id', profile.id)
        .eq('child_id', child.id)
        .maybeSingle()
```

```sql
-- 기존 RLS
CREATE POLICY "View own relations"
ON relations
FOR SELECT
USING (
    parent_id IN (SELECT id FROM users WHERE auth_user_id = auth.uid())
    OR child_id IN (SELECT id FROM users WHERE auth_user_id = auth.uid())
);
```

```sql
-- 해결 RLS
-- 1️⃣ 기존 정책 제거
DROP POLICY IF EXISTS "View own relations" ON relations;
DROP POLICY IF EXISTS "Insert own relations" ON relations;

-- 2️⃣ 새 정책: auth.users.uuid ↔ users.auth_user_id 비교
CREATE POLICY "Parents and children can view their relations"
ON relations
FOR SELECT
USING (
    EXISTS (
    SELECT 1 FROM users u
    WHERE u.id IN (relations.parent_id, relations.child_id)
    AND u.auth_user_id = auth.uid()
    )
);

CREATE POLICY "Parents can insert relations"
ON relations
FOR INSERT
WITH CHECK (
    EXISTS (
    SELECT 1 FROM users u
    WHERE u.id = relations.parent_id
    AND u.auth_user_id = auth.uid()
    AND u.role = 'PARENT'
    )
);

```

<br><br>

## 2. feat: 웹에서도 alert 볼 수 있게 util 추가

Alerm.alert는 웹에서 안보여서,

OS 분기처리해서 웹에서는 window.alert 사용하게 함.